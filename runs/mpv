#!/usr/bin/env bash

# This script installs the mpv media player using the Homebrew package manager.
# It first checks if Homebrew is installed and installs it if it's missing.

# Check if Homebrew command is available
if ! command -v brew &> /dev/null; then
    echo "Homebrew not found. Installing Homebrew..."
    # Install Homebrew using the official installation script
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

    # Add Homebrew to the current session's PATH.
    # The path depends on the system architecture (Apple Silicon vs Intel).
    echo "Adding Homebrew to your PATH..."
    if [[ "$(uname -m)" == 'arm64' ]]; then
        # For Apple Silicon (M1, M2, etc.)
        eval "$(/opt/homebrew/bin/brew shellenv)"
    else
        # For Intel-based Macs
        eval "$(/usr/local/bin/brew shellenv)"
    fi
    echo "You may need to add Homebrew to your shell's startup file (e.g., ~/.zshrc or ~/.bash_profile) permanently."
else
    echo "Homebrew is already installed."
fi

# Update Homebrew to get the latest package lists
echo "Updating Homebrew..."
brew update

# Install the mpv media player
echo "Installing mpv..."
brew install mpv

echo "mpv has been successfully installed."

